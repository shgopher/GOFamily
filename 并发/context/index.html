<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GOFamily - go ç¨‹åºå‘˜å®å…¸</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/x-icon" href="/GOFamily/favicon.ico">
    <meta name="description" content="ğŸ”¥ go ç¨‹åºå‘˜å®å…¸ï¼ŒåŒ…å«äº†ï¼šç®—æ³•ï¼Œæ•°æ®åº“ï¼Œç½‘ç»œæ“ä½œç³»ç»Ÿï¼Œåˆ†å¸ƒå¼ï¼Œç³»ç»Ÿè®¾è®¡ç­‰ä¸€æ½å­çŸ¥è¯†ä½“ç³»">
    
    <link rel="preload" href="/GOFamily/assets/css/0.styles.93ee3edc.css" as="style"><link rel="preload" href="/GOFamily/assets/js/app.6dac5fbf.js" as="script"><link rel="preload" href="/GOFamily/assets/js/2.5c331e53.js" as="script"><link rel="preload" href="/GOFamily/assets/js/107.abf9bc9d.js" as="script"><link rel="prefetch" href="/GOFamily/assets/js/10.993cf521.js"><link rel="prefetch" href="/GOFamily/assets/js/100.8a13422e.js"><link rel="prefetch" href="/GOFamily/assets/js/101.56e8a149.js"><link rel="prefetch" href="/GOFamily/assets/js/102.0befb22b.js"><link rel="prefetch" href="/GOFamily/assets/js/103.318b2dd9.js"><link rel="prefetch" href="/GOFamily/assets/js/104.5190ec56.js"><link rel="prefetch" href="/GOFamily/assets/js/105.27135b71.js"><link rel="prefetch" href="/GOFamily/assets/js/106.ee0a923b.js"><link rel="prefetch" href="/GOFamily/assets/js/108.339b1d12.js"><link rel="prefetch" href="/GOFamily/assets/js/109.7ee4cfe4.js"><link rel="prefetch" href="/GOFamily/assets/js/11.0307bcae.js"><link rel="prefetch" href="/GOFamily/assets/js/110.25bb24d2.js"><link rel="prefetch" href="/GOFamily/assets/js/111.800f7506.js"><link rel="prefetch" href="/GOFamily/assets/js/112.b73333d2.js"><link rel="prefetch" href="/GOFamily/assets/js/113.3bed7499.js"><link rel="prefetch" href="/GOFamily/assets/js/114.c126b120.js"><link rel="prefetch" href="/GOFamily/assets/js/115.773ca7ce.js"><link rel="prefetch" href="/GOFamily/assets/js/12.521ef871.js"><link rel="prefetch" href="/GOFamily/assets/js/13.6a579e8b.js"><link rel="prefetch" href="/GOFamily/assets/js/14.fa863532.js"><link rel="prefetch" href="/GOFamily/assets/js/15.ccbbdb7a.js"><link rel="prefetch" href="/GOFamily/assets/js/16.2a7384f8.js"><link rel="prefetch" href="/GOFamily/assets/js/17.50442aef.js"><link rel="prefetch" href="/GOFamily/assets/js/18.4b8a1599.js"><link rel="prefetch" href="/GOFamily/assets/js/19.fce83f0a.js"><link rel="prefetch" href="/GOFamily/assets/js/20.c57281b8.js"><link rel="prefetch" href="/GOFamily/assets/js/21.19939807.js"><link rel="prefetch" href="/GOFamily/assets/js/22.a6f2abf2.js"><link rel="prefetch" href="/GOFamily/assets/js/23.a3a10d16.js"><link rel="prefetch" href="/GOFamily/assets/js/24.edf743ad.js"><link rel="prefetch" href="/GOFamily/assets/js/25.c1fe94a5.js"><link rel="prefetch" href="/GOFamily/assets/js/26.529d156a.js"><link rel="prefetch" href="/GOFamily/assets/js/27.baf2939d.js"><link rel="prefetch" href="/GOFamily/assets/js/28.69e5608b.js"><link rel="prefetch" href="/GOFamily/assets/js/29.742dd6e8.js"><link rel="prefetch" href="/GOFamily/assets/js/3.159fe1e3.js"><link rel="prefetch" href="/GOFamily/assets/js/30.4aafb94a.js"><link rel="prefetch" href="/GOFamily/assets/js/31.87baab0b.js"><link rel="prefetch" href="/GOFamily/assets/js/32.1ea926c5.js"><link rel="prefetch" href="/GOFamily/assets/js/33.4d31d0db.js"><link rel="prefetch" href="/GOFamily/assets/js/34.7610889f.js"><link rel="prefetch" href="/GOFamily/assets/js/35.07f8b036.js"><link rel="prefetch" href="/GOFamily/assets/js/36.d1acb39c.js"><link rel="prefetch" href="/GOFamily/assets/js/37.1fac0e0a.js"><link rel="prefetch" href="/GOFamily/assets/js/38.53670642.js"><link rel="prefetch" href="/GOFamily/assets/js/39.9c8315fb.js"><link rel="prefetch" href="/GOFamily/assets/js/4.a73c4d70.js"><link rel="prefetch" href="/GOFamily/assets/js/40.c47687be.js"><link rel="prefetch" href="/GOFamily/assets/js/41.73deb46e.js"><link rel="prefetch" href="/GOFamily/assets/js/42.85cfacd9.js"><link rel="prefetch" href="/GOFamily/assets/js/43.1b441a63.js"><link rel="prefetch" href="/GOFamily/assets/js/44.5dc33e34.js"><link rel="prefetch" href="/GOFamily/assets/js/45.e7e66273.js"><link rel="prefetch" href="/GOFamily/assets/js/46.146ccd16.js"><link rel="prefetch" href="/GOFamily/assets/js/47.aa0964bb.js"><link rel="prefetch" href="/GOFamily/assets/js/48.0f67a15e.js"><link rel="prefetch" href="/GOFamily/assets/js/49.565c30a8.js"><link rel="prefetch" href="/GOFamily/assets/js/5.864fc44c.js"><link rel="prefetch" href="/GOFamily/assets/js/50.0f964c86.js"><link rel="prefetch" href="/GOFamily/assets/js/51.9dd5ff4a.js"><link rel="prefetch" href="/GOFamily/assets/js/52.d3f06485.js"><link rel="prefetch" href="/GOFamily/assets/js/53.60bb95e9.js"><link rel="prefetch" href="/GOFamily/assets/js/54.ee26f0f5.js"><link rel="prefetch" href="/GOFamily/assets/js/55.7b5dc58d.js"><link rel="prefetch" href="/GOFamily/assets/js/56.e3024720.js"><link rel="prefetch" href="/GOFamily/assets/js/57.74cebe2c.js"><link rel="prefetch" href="/GOFamily/assets/js/58.2eea170e.js"><link rel="prefetch" href="/GOFamily/assets/js/59.a733d97b.js"><link rel="prefetch" href="/GOFamily/assets/js/6.f4af1c68.js"><link rel="prefetch" href="/GOFamily/assets/js/60.31fce32e.js"><link rel="prefetch" href="/GOFamily/assets/js/61.025df443.js"><link rel="prefetch" href="/GOFamily/assets/js/62.dfeb9d10.js"><link rel="prefetch" href="/GOFamily/assets/js/63.088bb315.js"><link rel="prefetch" href="/GOFamily/assets/js/64.7503aa28.js"><link rel="prefetch" href="/GOFamily/assets/js/65.9e82002d.js"><link rel="prefetch" href="/GOFamily/assets/js/66.fd22a77b.js"><link rel="prefetch" href="/GOFamily/assets/js/67.613f77e3.js"><link rel="prefetch" href="/GOFamily/assets/js/68.42cf41b2.js"><link rel="prefetch" href="/GOFamily/assets/js/69.a1051de8.js"><link rel="prefetch" href="/GOFamily/assets/js/7.5c52a687.js"><link rel="prefetch" href="/GOFamily/assets/js/70.8c3a3873.js"><link rel="prefetch" href="/GOFamily/assets/js/71.57746954.js"><link rel="prefetch" href="/GOFamily/assets/js/72.5afe8bc8.js"><link rel="prefetch" href="/GOFamily/assets/js/73.03d8974c.js"><link rel="prefetch" href="/GOFamily/assets/js/74.4f1eeb3c.js"><link rel="prefetch" href="/GOFamily/assets/js/75.d44fc2e7.js"><link rel="prefetch" href="/GOFamily/assets/js/76.f53bf284.js"><link rel="prefetch" href="/GOFamily/assets/js/77.bad2588a.js"><link rel="prefetch" href="/GOFamily/assets/js/78.2ee31447.js"><link rel="prefetch" href="/GOFamily/assets/js/79.f5c3f20d.js"><link rel="prefetch" href="/GOFamily/assets/js/8.419c1695.js"><link rel="prefetch" href="/GOFamily/assets/js/80.5aa44af4.js"><link rel="prefetch" href="/GOFamily/assets/js/81.33455a03.js"><link rel="prefetch" href="/GOFamily/assets/js/82.9f2284bd.js"><link rel="prefetch" href="/GOFamily/assets/js/83.5dc60988.js"><link rel="prefetch" href="/GOFamily/assets/js/84.b93653e7.js"><link rel="prefetch" href="/GOFamily/assets/js/85.17171820.js"><link rel="prefetch" href="/GOFamily/assets/js/86.411754fa.js"><link rel="prefetch" href="/GOFamily/assets/js/87.94cb9c84.js"><link rel="prefetch" href="/GOFamily/assets/js/88.bf9b9181.js"><link rel="prefetch" href="/GOFamily/assets/js/89.30daa2d3.js"><link rel="prefetch" href="/GOFamily/assets/js/9.0852bf61.js"><link rel="prefetch" href="/GOFamily/assets/js/90.86c77607.js"><link rel="prefetch" href="/GOFamily/assets/js/91.77196b7c.js"><link rel="prefetch" href="/GOFamily/assets/js/92.52bff9af.js"><link rel="prefetch" href="/GOFamily/assets/js/93.2ad1e17b.js"><link rel="prefetch" href="/GOFamily/assets/js/94.cb498e95.js"><link rel="prefetch" href="/GOFamily/assets/js/95.3eff79bb.js"><link rel="prefetch" href="/GOFamily/assets/js/96.01bee062.js"><link rel="prefetch" href="/GOFamily/assets/js/97.46e63812.js"><link rel="prefetch" href="/GOFamily/assets/js/98.843925cf.js"><link rel="prefetch" href="/GOFamily/assets/js/99.d9206bf1.js">
    <link rel="stylesheet" href="/GOFamily/assets/css/0.styles.93ee3edc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/GOFamily/" class="home-link router-link-active"><img src="https://avatars.githubusercontent.com/u/42873232" alt="GOFamily - go ç¨‹åºå‘˜å®å…¸" class="logo"> <span class="site-name can-hide">GOFamily - go ç¨‹åºå‘˜å®å…¸</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/GOFamily/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Menu" class="dropdown-title"><span class="title">ç³»åˆ—æ•™ç¨‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="Menu" class="mobile-dropdown-title"><span class="title">ç³»åˆ—æ•™ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/GOFamily/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GOFamily ã€goè¯­è¨€æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/408/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  408  ã€åŸºç¡€408çŸ¥è¯†æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/luban/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  luban  ã€ç³»ç»Ÿè®¾è®¡æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/dingdang/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  dingdang  ã€å·¥å…·æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/god/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  god  ã€ç»™ç¨‹åºå‘˜å†™çš„ä¹¦ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://shgopher.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä½œè€…
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/shgopher/GOFamily" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/GOFamily/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Menu" class="dropdown-title"><span class="title">ç³»åˆ—æ•™ç¨‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="Menu" class="mobile-dropdown-title"><span class="title">ç³»åˆ—æ•™ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/GOFamily/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GOFamily ã€goè¯­è¨€æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/408/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  408  ã€åŸºç¡€408çŸ¥è¯†æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/luban/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  luban  ã€ç³»ç»Ÿè®¾è®¡æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/dingdang/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  dingdang  ã€å·¥å…·æ•™ç¨‹ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://shgopher.github.io/god/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  god  ã€ç»™ç¨‹åºå‘˜å†™çš„ä¹¦ã€‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://shgopher.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä½œè€…
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/shgopher/GOFamily" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#ä½¿ç”¨-context" class="sidebar-link">ä½¿ç”¨ context</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#withvalue" class="sidebar-link">withValue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#withcancel" class="sidebar-link">WithCancel</a></li><li class="sidebar-sub-header"><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#withtimeout-withdeadline" class="sidebar-link">withTimeout withDeadline</a></li></ul></li><li><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#å¸¦æœ‰-cause-çš„å‡½æ•°" class="sidebar-link">å¸¦æœ‰ cause çš„å‡½æ•°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#åœ¨-withtimeout-ä¸­-cancel-å‡½æ•°çš„å­˜åœ¨æ„ä¹‰æ˜¯ä»€ä¹ˆ" class="sidebar-link">åœ¨ WithTimeout ä¸­ cancel() å‡½æ•°çš„å­˜åœ¨æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#issues" class="sidebar-link">issues</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/GOFamily/%E5%B9%B6%E5%8F%91/context/#contex-contex-å¦‚ä½•å®ç°å¹¶å‘å®‰å…¨çš„" class="sidebar-link">contex.Contex å¦‚ä½•å®ç°å¹¶å‘å®‰å…¨çš„ï¼Ÿ</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="context">context</h1> <p>context åº”è¯¥è¢«ç¿»è¯‘ä¸ºä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯ go è¯­è¨€ä¸­çš„ context æ›´å¤šçš„ä½œç”¨æ˜¯<strong>å–æ¶ˆå­ goroutine</strong>ï¼Œä¼ é€’ä¿¡æ¯è¿™ä¸ªä¸Šä¸‹æ–‡æœ¬æ¥çš„å«ä¹‰ï¼Œåœ¨ go çš„ context åè€Œä¸æ˜¯é‡ç‚¹</p> <p>context æœ¬èº«æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œå®ƒæ‹¥æœ‰å››ä¸ªæ–¹æ³•ï¼š</p> <ul><li>Deadline()(deadline time.Time,ok bool)ï¼šè¿”å›ä¸€ä¸ªä»£è¡¨æ­¤ä¸Šä¸‹æ–‡å®Œæˆå·¥ä½œçš„æ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰æˆªæ­¢æ—¶é—´ï¼Œè¿”å› false</li> <li>Done() &lt;-chan struct {}ï¼šä»£è¡¨äº†å®Œç»“</li> <li>Err() errorï¼šå¦‚æœ context å·²ç» done äº†è¿”å›ä¸€ä¸ª error é”™è¯¯ï¼Œé”™è¯¯å€¼åˆ†åˆ«ä¸ºï¼šCanceledï¼ŒDeadlineExceededï¼Œå¦‚æœæ²¡æœ‰ doneï¼Œerror è¿”å› nil</li> <li>Value(key any) anyï¼šcontext ä¸­å­˜å‚¨çš„é”®å€¼å¯¹</li></ul> <p>context ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œéœ€è¦ä¸€ä¸ªæœ€é¡¶å±‚çš„ context æ¥å£ç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>context.Background()</code> æˆ–è€… <code>context.TODO()</code> å»å……å½“è¿™ä¸ªé¡¶ç«¯ï¼Œè¿™ä¸¤è€…æ˜¯ä¸€ä¸ªæ„æ€ï¼Œç”¨å“ªä¸ªéƒ½å¯ä»¥ï¼Œè¿™æ˜¯ go æä¾›çš„å·²ç»å®ç°äº† context æ¥å£ç±»å‹çš„å¯¹è±¡ï¼Œå®ƒçš„åº•å±‚æ˜¯ä¸€ä¸ªç»“æ„ä½“</p> <p>context æœ‰ä¸€äº›ç¼–ç¨‹èŒƒå¼ï¼š</p> <ul><li>å°† cotext è®¾ç½®ä¸ºå‚æ•°çš„ç¬¬ä¸€ä¸ªï¼Œä¾‹å¦‚ <code>func age(ctx context.Context,a string)</code></li> <li>ä¸è¦ä½¿ç”¨ nil ä½œä¸ºä¸Šä¸‹æ–‡å‚æ•°ï¼Œå¦‚æœæƒ³è¦ç©ºçš„é¡¶ç«¯ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ <code>context.Background</code>ï¼Œè™½ç„¶ background åº•å±‚å®ç°æ¥å£çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å†…å®¹ä¸ºç©ºï¼Œä½†æ˜¯å®ƒçš„ç¡®æ˜¯å®ç°äº†æ¥å£</li> <li>context åªèƒ½ä½œä¸ºå‡½æ•°çš„ä¸´æ—¶ä¼ é€’å¯¹è±¡ï¼Œä¸èƒ½æŒä¹…åŒ–å®ƒï¼Œä½¿ç”¨æ•°æ®åº“ä¿å­˜ï¼Œç­‰æŒä¹…åŒ–æ–¹å¼éƒ½æ˜¯ä¸å¯å–çš„</li> <li>ä½¿ç”¨ withValue æ–¹æ³•çš„æ—¶å€™ï¼Œkey å€¼ä¸è¦ä½¿ç”¨ stringï¼Œå¦‚æœèµ·å†²çªï¼Œä½¿ç”¨è‡ªå»ºçš„ç±»å‹ï¼Œä¾‹å¦‚ <code>type A struct{}</code></li> <li>å°½é‡ä¸è¦å®šä¹‰è¾“å‡ºçš„ key å€¼</li></ul> <h2 id="ä½¿ç”¨-context">ä½¿ç”¨ context</h2> <p>æ ‡å‡†åº“ä¸­æä¾›äº†å¤šä¸ª context æ¥å£ç±»å‹å®ä¾‹ï¼š</p> <ul><li>WithCancel</li> <li>WithCancelCause</li> <li>WithDeadline</li> <li>WithDeadlineCause</li> <li>WithTimeout</li> <li>WithTimeoutCause</li></ul> <p>å…¶ä¸­ï¼Œå¸¦æœ‰ Cause çš„å‡½æ•°è·Ÿä¸å¸¦çš„å‡½æ•°åŸºæœ¬æ„æ€ç›¸åŒï¼Œä½†æ˜¯å¤šäº†ä¸€ä¸ª cause çš„å†…å®¹ï¼Œå®ƒæ˜¯æŒ‡çš„æ˜¯å–æ¶ˆçš„åŸå› </p> <h2 id="withvalue">withValue</h2> <p>WithValue åŸºäº parent Context ç”Ÿæˆä¸€ä¸ªæ–°çš„ Contextï¼Œä¿å­˜äº†ä¸€ä¸ª key-value é”®å€¼
å¯¹ã€‚å®ƒå¸¸å¸¸ç”¨æ¥ä¼ é€’ä¸Šä¸‹æ–‡ã€‚</p> <p>context åœ¨æŸ¥è¯¢ key å€¼çš„æ—¶å€™è¿˜æ”¯æŒé“¾å¼æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰å‘ç°æ•°æ®å°±å¾€ parent context ä¸­æŸ¥è¯¢</p> <div class="language-go extra-class"><pre class="language-go"><code>ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;key1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0001&quot;</span><span class="token punctuation">)</span>
ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;key2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0001&quot;</span><span class="token punctuation">)</span>
ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;key3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0001&quot;</span><span class="token punctuation">)</span>
ctx <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;key4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0004&quot;</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="withcancel">WithCancel</h3> <p>withCancel è¿”å›çˆ¶ context ä¸­çš„ ctx å®ä¾‹å‰¯æœ¬ï¼Œå®ƒç›¸å½“äºçˆ¶ context çš„å­ contextï¼Œå¹¶ä¸”åœ¨çˆ¶ context è¢«å–æ¶ˆæ—¶ï¼Œå­ context ä¹Ÿä¼šè¢«å–æ¶ˆã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">withCancel</span><span class="token punctuation">(</span>parent Context<span class="token punctuation">)</span> <span class="token operator">*</span>cancelCtx <span class="token punctuation">{</span>
	<span class="token keyword">if</span> parent <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;cannot create context from nil parent&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	c <span class="token operator">:=</span> <span class="token operator">&amp;</span>cancelCtx<span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// å‘ä¸Šå¯»æ‰¾</span>
	c<span class="token punctuation">.</span><span class="token function">propagateCancel</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
	<span class="token keyword">return</span> c
<span class="token punctuation">}</span>
</code></pre></div><p>propagateCancel éƒ¨åˆ†ä»£ç ï¼š</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cancelCtx<span class="token punctuation">)</span> <span class="token function">propagateCancel</span><span class="token punctuation">(</span>parent Context<span class="token punctuation">,</span> child canceler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c<span class="token punctuation">.</span>Context <span class="token operator">=</span> parent

	done <span class="token operator">:=</span> parent<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> done <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token comment">// parent is never canceled</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>done<span class="token punctuation">:</span>
		<span class="token comment">// å¦‚æœçˆ¶doneäº†ï¼Œé‚£ä¹ˆå­ctxä¸€å®šä¹Ÿä¼šå‡ºå‘cancel</span>
		child<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> parent<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Cause</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> p<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token function">parentCancelCtx</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token comment">// parent is a *cancelCtx, or derives from one.</span>
		p<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> p<span class="token punctuation">.</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token comment">// å¦‚æœçˆ¶å‘ç”Ÿäº†cancelï¼Œé‚£ä¹ˆå­ctxä¹Ÿè¦è§¦å‘cancel</span>
			child<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>err<span class="token punctuation">,</span> p<span class="token punctuation">.</span>cause<span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> p<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				p<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>canceler<span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
      <span class="token comment">// å°†å­ctxæ·»åŠ åˆ°çˆ¶ctxä¸­</span>
			p<span class="token punctuation">.</span>children<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		p<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
  <span class="token operator">...</span>
  <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
      <span class="token comment">// çˆ¶ doneè¢«è§¦å‘ï¼Œé‚£ä¹ˆå­ctxå°±ä¼šè¢«è§¦å‘cancelæ“ä½œ</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span> parent<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			child<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> parent<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Cause</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>child<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> canceler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">cancel</span><span class="token punctuation">(</span>removeFromParent <span class="token builtin">bool</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> cause <span class="token builtin">error</span><span class="token punctuation">)</span>
	<span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>propagateCancel å°† c å‘ä¸Šä¼ æ’­ï¼Œé¡ºç€ parent çš„è·¯å¾„ä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ° parentCancelCtxï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œå°±æŠŠè‡ªå·±åŠ å…¥åˆ°è¿™ä¸ª parentCancelCtx çš„ children åˆ‡ç‰‡ä¸­ï¼Œç„¶åå°±å¯ä»¥åœ¨çˆ¶ ctx å–æ¶ˆçš„æ—¶å€™ï¼Œé€šçŸ¥è‡ªå·±ä¹Ÿè¢«å–æ¶ˆ</p> <p>å½“è¿™ä¸ª cancelCtx çš„ cancel å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œparent çš„ Done è¢« close çš„æ—¶å€™ï¼Œæˆ–è€…çˆ¶ ctx è§¦å‘äº† cancel çš„æ—¶å€™ï¼Œè¿™ä¸ªå­ ctx ä¼šè¢«è§¦å‘ cancel åŠ¨ä½œ</p> <p>cancel æ˜¯å‘ä¸‹ä¼ é€’çš„ï¼Œå¦‚æœä¸€ä¸ª WithCancel ç”Ÿæˆçš„ Context è¢« cancel æ—¶ï¼Œå¦‚æœå®ƒçš„å­ Context (ä¹Ÿæœ‰å¯èƒ½æ˜¯å­™ï¼Œæˆ–è€…æ›´ä½)ï¼Œå°±ä¼šè¢« cancelï¼Œä½†æ˜¯ä¸ä¼šå‘ä¸Šä¼ é€’ã€‚parent Context ä¸ä¼šå› ä¸ºå­ Context è¢« cancel è€Œ cancelã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancel</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">{</span>
			<span class="token keyword">select</span> <span class="token punctuation">{</span>
			<span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
				fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;done&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
  time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>WithCancel è¿”å› parent context çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå®ƒè‡ªç„¶å°±æ˜¯å­ contextï¼Œå½“çˆ¶ context è¢« cancel çš„æ—¶å€™ï¼Œå­ context ä¹Ÿä¼šè¢« cancel</p> <h3 id="withtimeout-withdeadline">withTimeout withDeadline</h3> <p>è¿™ä¸¤ä¸ªåªæ˜¯æ·»åŠ äº†åˆ°æœŸæ—¶é—´ï¼Œä¸€ä¸ªæ˜¯è¶…æ—¶æ—¶é—´ï¼Œä¸€ä¸ªæ˜¯æˆªæ­¢æ—¶é—´ï¼Œä¸€æ—¦è¶…è¿‡æ—¶é—´åï¼Œè‡ªåŠ¨ close è¿™ä¸ª done è¿™ä¸ª channel</p> <p>ç»¼ä¸Šæ‰€è¿°ï¼Œdone è¿™ä¸ª channel è¢« close æœ‰ä¸‰ä¸ªåŸå› ï¼š</p> <ul><li>æˆªæ­¢æ—¶é—´åˆ°äº†</li> <li>cancel å‡½æ•°è¢«è°ƒç”¨äº†</li> <li>parent context çš„ done close äº†ï¼Œç„¶åå­ ctx ä¹Ÿè¦è§¦å‘ cancel æ–¹æ³•</li> <li>parent context cancel äº†è§¦å‘å­ ctx cancel æ–¹æ³•</li></ul> <p>å…³äºç¬¬ä¸‰æ¡ï¼Œè§£é‡Šä¸€ä¸‹ï¼š(ç¬¬å››æ¡ç±»ä¼¼)</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// åˆ›å»ºä¸€ä¸ªçˆ¶context,è®¾ç½®deadlineä¸º3ç§’</span>
	parentCtx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithTimeout</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ªå­context,deadlineç»§æ‰¿çˆ¶context</span>
	childCtx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancel</span><span class="token punctuation">(</span>parentCtx<span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// æ³¨æ„è¿™é‡Œéœ€è¦è°ƒç”¨cancel</span>

	<span class="token keyword">go</span> <span class="token function">doWork</span><span class="token punctuation">(</span>childCtx<span class="token punctuation">)</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">14</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">doWork</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token punctuation">{</span>
		<span class="token keyword">select</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		   <span class="token comment">// å·¥ä½œä»£ç </span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;over&quot;</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
	<span class="token comment">//default:</span>
	<span class="token comment">//	fmt.Println(&quot;default&quot;)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>åœ¨ä½¿ç”¨ select ç›‘å¬ Context çš„ Done é€šé“æ—¶ï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨ default åˆ†æ”¯ã€‚</p> <p>åŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p> <ul><li>default åˆ†æ”¯ä¼šå¯¼è‡´æ— æ³•å‡†ç¡®æ£€æµ‹åˆ° Context cancellation çš„ä¿¡å·ï¼Œå¦‚æˆ‘ä»¬ä¹‹å‰åˆ†æçš„é‚£æ ·</li> <li>ä½¿ç”¨ default æ—¶éœ€è¦ä»”ç»†è®¾è®¡ case åˆ†æ”¯çš„é˜»å¡æ—¶é—´ï¼Œæ¯”è¾ƒ tricky</li> <li>ä¸ä½¿ç”¨ default å¯ä»¥ç¡®ä¿æ¯æ¬¡ select éƒ½ä¼šé˜»å¡ï¼Œä»è€Œèƒ½æ•æ‰åˆ°å¤–éƒ¨çš„å–æ¶ˆé€šçŸ¥</li> <li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä½¿ç”¨ default ä¹Ÿå¯ä»¥ä½¿ä»£ç æ›´ç®€æ´</li></ul> <h2 id="å¸¦æœ‰-cause-çš„å‡½æ•°">å¸¦æœ‰ cause çš„å‡½æ•°</h2> <p>æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;context&quot;</span>
	<span class="token string">&quot;errors&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> myError <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;myError&quot;</span><span class="token punctuation">)</span>
	ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancelCause</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">cancel</span><span class="token punctuation">(</span>myError<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                       
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Cause</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// returns myError</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½†æˆ‘ä»¬è°ƒç”¨ cancel å‡½æ•°çš„æ—¶å€™ï¼Œå†…éƒ¨å‚æ•°æ˜¯ä¸€ä¸ª error ç±»å‹ï¼Œè°ƒç”¨ context.Cause(ctx) è¿”å›çš„å°±æ˜¯å®ƒçš„å–æ¶ˆåŸå› ï¼Œé‚£ä¹ˆè¿™é‡Œçš„è¯å°±æ˜¯ MyError</p> <h2 id="åœ¨-withtimeout-ä¸­-cancel-å‡½æ•°çš„å­˜åœ¨æ„ä¹‰æ˜¯ä»€ä¹ˆ">åœ¨ WithTimeout ä¸­ cancel() å‡½æ•°çš„å­˜åœ¨æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ</h2> <p>cancel å‡½æ•°çš„ä½œç”¨æ˜¯å¯ä»¥æ‰‹åŠ¨æå‰å–æ¶ˆ Contextï¼Œä½¿å…¶ Done channel å…³é—­ï¼Œä¸ç”¨ç­‰å¾… timeout çš„æ—¶é—´æˆ–è€… deadline çš„æ—¶é—´</p> <p>æ‰€ä»¥ cancel å‡½æ•°ç›¸å½“äºæ‰‹åŠ¨å–æ¶ˆçš„æ„æ€ï¼Œå¹¶ä¸æ˜¯è¯´æœ‰äº† timeout deadline ä¹‹åï¼Œcancel å‡½æ•°å°±æ²¡æœ‰å­˜åœ¨çš„æ„ä¹‰äº†ã€‚</p> <p>æŒ‰ç…§ go çš„è¯­æ³•ï¼Œå³ä¾¿æ˜¯ timeout è§¦å‘äº† &lt;- done æ“ä½œï¼Œä½ ä»ç„¶éœ€è¦æ‰‹åŠ¨çš„å»åœ¨æœ€åè°ƒç”¨ cancel å‡½æ•°ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™</p> <p>WithTimeout åœ¨è¶…æ—¶æ—¶ä¼šè‡ªåŠ¨ cancel contextï¼Œä½†æ˜¯ cancel å‡½æ•°è¿˜æ˜¯éœ€è¦è°ƒç”¨ï¼Œä»¥é‡Šæ”¾/é‡ç½® Context å†…éƒ¨çš„ timerï¼Œå¦‚æœä¸è°ƒç”¨ cancelï¼Œtimer ä¸ä¼šè¢«é‡Šæ”¾ï¼ŒæŒç»­è¿è¡Œå¹¶é‡å¤ cancel å¯¼è‡´ context leakï¼Œå ç”¨æ›´å¤šèµ„æºã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code>ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithTimeout</span><span class="token punctuation">(</span>parentCtx<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>

<span class="token keyword">go</span> <span class="token function">doWork</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> 

<span class="token comment">// 1ç§’åå†³å®šå–æ¶ˆä»»åŠ¡</span>
time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">*</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>  
<span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="issues">issues</h2> <h3 id="contex-contex-å¦‚ä½•å®ç°å¹¶å‘å®‰å…¨çš„">contex.Contex å¦‚ä½•å®ç°å¹¶å‘å®‰å…¨çš„ï¼Ÿ</h3> <p>Go è¯­è¨€ä¸­ context å®ç°å¹¶å‘å®‰å…¨çš„ä¸»è¦æ‰‹æ®µæ˜¯é€šè¿‡åŸå­æ“ä½œå’Œ Mutex æ¥ä¿è¯çŠ¶æ€çš„åŸå­æ€§</p> <p>æ ¹æ®åº•å±‚ä»£ç å¯çŸ¥ï¼Œå½“ä¸åŒçš„ goroutine è·å– ctx çš„æ—¶å€™ï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šåŠ ä¸Šäº’æ–¥é”ï¼Œæ¥ä¿è¯æ•°æ®çš„éç«äº‰æ€§ï¼Œçº¿ç¨‹çš„å®‰å…¨ï¼Œä¾‹å¦‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">if</span> p<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token function">parentCancelCtx</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
		<span class="token comment">// parent is a *cancelCtx, or derives from one.</span>
		p<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> p<span class="token punctuation">.</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			<span class="token comment">// å¦‚æœçˆ¶å‘ç”Ÿäº†cancelï¼Œé‚£ä¹ˆå­ctxä¹Ÿè¦è§¦å‘cancel</span>
			child<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span>err<span class="token punctuation">,</span> p<span class="token punctuation">.</span>cause<span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> p<span class="token punctuation">.</span>children <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
				p<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>canceler<span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
      <span class="token comment">// å°†å­ctxæ·»åŠ åˆ°çˆ¶ctxä¸­</span>
			p<span class="token punctuation">.</span>children<span class="token punctuation">[</span>child<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		p<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/shgopher/GOFamily/edit/release/å¹¶å‘/context/README.md" target="_blank" rel="noopener noreferrer">åœ¨GitHubä¸­ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°:</span> <span class="time">2/27/2024, 3:25:55 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/GOFamily/assets/js/app.6dac5fbf.js" defer></script><script src="/GOFamily/assets/js/2.5c331e53.js" defer></script><script src="/GOFamily/assets/js/107.abf9bc9d.js" defer></script>
  </body>
</html>
